# Assume --without-pcre by default
%{|?_with_pcre: %{|?_without_pcre: %define _without_pcre --without-pcre}}

%define	ver	@VERSION@
%define	rel	1
%define	prefix	/usr

Prefix:	%{prefix}

Summary       : Hightlight interesting /var/log/messages entries
Name          : vlm-tool
Version       : %{ver}
Release       : %{rel}
License       : GPLv2
Group         : User Interface/Desktops
Source        : %{name}-%{version}.tar.gz
BuildRoot     : %{_tmppath}/%{name}-%{version}-root
%{?_with_pcre:BuildRequires: pcre}

%description
The vlm-tool(1) reads one or more system log files (/var/log/messages) from
one or more systems.  The entries are filtered against a known set of trigger
patterns.  Those entries which are matched, are then sorted and printed.

Using this tool should make browsing many log files from many systems more
palatable by highlighting entries which could indicate an issue.
%prep
%setup -q

%build
	[ -f configure ] || ./autogen.sh
	./configure %{?_with_pcre} %{?_without_pcre}
	make

%install
	rm -rf %{buildroot}
	make prefix=$RPM_BUILD_ROOT%{prefix} install

%clean
	rm -rf %{buildroot}

%files
%defattr(-, root, root)
%doc AUTHORS
%doc COPYING
%doc ChangeLog
%doc INSTALL
%doc NEWS
%doc README
%{_bindir}/vlm-tool
%{_mandir}/man1/vlm-tool.1.gz

%changelog
